<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Relatório de Passagem de Serviço</title>
    {% load static %}

    <!-- Bootstrap CSS -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }
      header {
        background-color: #343a40;
        color: white;
        padding: 10px;
        border-radius: 8px;
      }
      .section {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      table {
        margin-top: 10px;
      }
      th {
        background-color: #343a40;
        color: white;
      }
    </style>
  </head>
  <body class="container my-4">
    <header class="text-center fs-3 fw-bold">
      LIVRO DE CAUTELA - {{ data_fim }}
    </header>

    <div class="section mb-4">
      <div class="row">
        <div class="col-md-8">
          <img
            src="{% static 'cautelaarmamento/images/logo.png' %}"
            alt="Logo"
            class="mb-3"
            style="width: 130px"
          />
          <h4 class="mb-0">
            ESTADO DO MARANHÃO<br />
            SECRETARIA DE ESTADO DA SEGURANÇA PÚBLICA<br />
            POLÍCIA MILITAR DO MARANHÃO<br />
            COMANDO DO POLICIAMENTO DO INTERIOR - CPI<br />
            COMANDO DO POLICIAMENTO DE ÁREA DO INTERIOR – CPA/I 04<br />
            11º BATALHÃO DE POLÍCIA MILITAR – 4ª CIA MATÕES
          </h4>
        </div>
        <div class="col-md-4 text-center">
          <h4>2º TEN QOPM CURY</h4>
          <h5>CMT da 4ª CIA</h5>
        </div>
      </div>

      <div class="section my-4">
        <h3 class="fw-bold">ASSUNÇÃO DO SERVIÇO</h3>
        <p class="lead">
          Parte diária do(a) {{ usuario }} armeiro(a) de serviço de 24Hs do dia
          {{ data_inicio|date:"d/m/Y" }} para o dia {{ data_fim|date:"d/m/Y" }},
          as {{ hora_atual }} ao CMT da 4ª CIA/11º BPM.
        </p>
      </div>
    </div>

    <h3 class="fw-bold mb-4">CAUTELA DIÁRIA</h3>

    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Policial</th>
            <th scope="col">Subcategoria</th>
            <th scope="col">Data da Cautela</th>
          </tr>
        </thead>
        <tbody>
          {% for cautela in cautelas %}
          <tr>
            <td>{{ cautela.id }}</td>
            <td>{{ cautela.policial }}</td>
            <td>{{ cautela.subcategoria }}</td>
            <td>{{ cautela.hora_cautela|date:"d/m/Y H:i" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">
              Nenhuma cautela registrada.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h3 class="fw-bold mb-4">CAUTELA DE MUNIÇÕES</h3>

    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Policial</th>
            <th scope="col">Subcategoria</th>
            <th scope="col">Quantidade</th>
          </tr>
        </thead>
        <tbody>
          {% for cautela in cautela_municoes %}
          <tr>
            <td>{{ cautela.id }}</td>
            <td>{{ cautela.policial }}</td>
            <td>{{ cautela.subcategoria }}</td>
            <td>{{ cautela.quantidade}}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">
              Nenhuma cautela registrada.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h3 class="fw-bold mt-5 mb-4">DESCAUTELAS DIÁRIA S/A</h3>

    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Policial</th>
            <th scope="col">Arma, VTR, e Equipamentos</th>
            <th scope="col">Munições</th>
            <th scope="col">Data da Descautela</th>
          </tr>
        </thead>
        <tbody>
          {% for descautela in descautelas %}
          <tr>
            <td>{{ descautela.data_hora_cautela|date:"d/m/Y H:i" }}</td>
            <td>{{ descautela.policial|default:"" }}</td>
            <td>{{ descautela.subcategoria_armamento|default:"" }}</td>
            <td>{{ descautela.subcategoria_municao|default:"" }}</td>
            <td>{{ descautela.hora_descautelamento|date:"d/m/Y H:i" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center text-muted">
              Nenhuma descautela registrada.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h3 class="fw-bold mt-5 mb-4">DESCAUTELAS DIÁRIA C/A</h3>

    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Policial</th>
            <th scope="col">Arma, VTR, e Equipamentos</th>
            <th scope="col">Munições</th>
            <th scope="col">Data da Descautela</th>
          </tr>
        </thead>
        <tbody>
          {% for descautela in descautelas_ca %}
          <tr>
            <td>{{ descautela.data_hora_cautela }}</td>
            <td>{{ descautela.policial }}</td>
            <td>{{ descautela.subcategoria_armamento }}</td>
            <td>{{ descautela.subcategoria_municao }}</td>
            <td>{{ descautela.hora_descautelamento|date:"d/m/Y H:i" }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="5" class="text-center text-muted">
              Nenhuma descautela registrada.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h3 class="fw-bold mt-5 mb-4">MATERIAL DISPONÍVEL NA RESERVA</h3>

    {% if material_disponivel %}
        {% for categoria, itens in material_disponivel.items %}
            <div class="section mb-4">
                <h4 class="fw-bold">{{ categoria }}</h4>
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">Descrição</th>
                                <th scope="col">Marca</th>
                                <th scope="col">Modelo</th>
                                <th scope="col">Calibre</th>
                                <th scope="col">Nº Arma</th>
                                <th scope="col">Nº PMMA</th>
                                <th scope="col">Localização</th>
                                <th scope="col">Estado de Conservação</th>
                                <th scope="col">Observação</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in itens %}
                                <tr>
                                    <td>{{ item.descricao_completa }}</td>
                                    <td>{{ item.marca }}</td>
                                    <td>{{ item.modelo }}</td>
                                    <td>{{ item.cal }}</td>
                                    <td>{{ item.num_arma }}</td>
                                    <td>{{ item.num_pmma }}</td>
                                    <td>{{ item.localizacao }}</td>
                                    <td>{{ item.estado_conservacao }}</td>
                                    <td>{{ item.observacao }}</td>
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="9" class="text-center text-muted">
                                        Nenhum item disponível nesta categoria.
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        {% empty %}
            <p class="text-center text-muted">Nenhum item disponível na reserva.</p>
        {% endfor %}
    {% else %}
        <p class="text-center text-muted">Nenhum item disponível na reserva.</p>
    {% endif %}
    
    

    <div class="section my-4">
      <h3 class="fw-bold">PASSAGEM DE SERVIÇO</h3>
      <p class="lead">
        Fiz ao meu substituto legal o {{ nome_substituto }} , a quem repassei
        todas as ordens em vigor bem como todo o material da carga da
        4ªCIA/11ºBPM {{ descautelas_ca_status }}.
      </p>
      <div class="text-center mt-4">
        <form method="POST" action="{% url 'gerar_relatorio' %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-primary">Gerar Relatório</button>
      </form>
      </div>

    <footer class="text-center mt-5">
      <p class="text-muted">
        &copy; {{ data_fim|date:"Y" }} 11º Batalhão de Policia Militar do
        Maranhão
      </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
